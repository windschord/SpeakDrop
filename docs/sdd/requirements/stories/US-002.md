# US-002: テキスト後処理（句読点挿入・整形）

## ユーザーストーリー

**私は** macOSユーザーとして
**〜したい** 音声認識結果に句読点が自動挿入され、話し言葉が書き言葉に整形されたテキストを得たい
**なぜなら** 音声認識の生テキストはそのままでは読みにくく、手動での修正に時間がかかるから

## 受入基準（EARS記法）

### 機能要件

- **REQ-007**: 音声認識が完了した時、システムはOllama LLM（qwen2.5:7b）を使用して認識結果に句読点（。、！？）を挿入しなければならない
- **REQ-008**: 音声認識が完了した時、システムはOllama LLMを使用して話し言葉を書き言葉に整形しなければならない
- **REQ-009**: もしOllamaが起動していない場合、システムは後処理をスキップし、音声認識の生テキストをそのまま挿入しなければならない

## 画面/UI要件

該当なし（バックグラウンド処理）

## データ要件

- 使用モデル: qwen2.5:7b（推奨）
- 入力: 音声認識の生テキスト
- 出力: 句読点付き・書き言葉整形済みテキスト

## 関連ストーリー

- [US-001](US-001.md) @US-001.md: プッシュトークによる音声入力（後処理の前提）
- [US-005](US-005.md) @US-005.md: 音声認識モデルの設定

## 備考

- Ollamaは事前にインストール・起動が必要（外部依存）
- `ollama pull qwen2.5:7b` で事前にモデルを取得する必要がある
- Ollamaが利用不可の場合はフォールバックとして生テキストを使用する（グレースフルデグラデーション）
